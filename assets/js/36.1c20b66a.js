(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{318:function(t,s,a){"use strict";a.r(s);var e=a(10),r=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"centos7搭建vsftp"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#centos7搭建vsftp"}},[t._v("#")]),t._v(" "),s("center",[t._v("centos7搭建vsftp")])],1),t._v(" "),s("h2",{attrs:{id:"安装应用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装应用"}},[t._v("#")]),t._v(" 安装应用")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("yum "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-y")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" pam pam-devel db4 db4-tcl\nyum "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-y")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" vsftpd\n")])])]),s("h2",{attrs:{id:"备份配置文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#备份配置文件"}},[t._v("#")]),t._v(" 备份配置文件")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cp")]),t._v(" /etc/vsftpd/vsftpd.conf /etc/vsftpd/vsftpd.conf.back\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" /etc/vsftpd/vsftpd.conf\n")])])]),s("div",{staticClass:"language-conf extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("#允许/禁止本地用户登陆 注意：主要是为虚拟宿主用户，如果该项目设定为NO那么所有虚拟用户将无法访问。\nwrite_enable=YES\n#设定可以进行写操作。\nlocal_umask=022\n#设定上传后文件的权限掩码，文件644，文件夹755\ndirmessage_enable=YES\n#设定开启目录标语功能\nxferlog_enable=YES\n#设定开启日志记录功能。\nconnect_from_port_20=YES\n#设定端口20进行数据连接\nxferlog_std_format=YES\n#设定日志使用标准的记录格式\nlisten=YES\n#开启独立进程vsftpd，不使用超级进程xinetd。设定该Vsftpd服务工作在StandAlone模式下。\npam_service_name=vsftpd\n#设定，启用pam认证，并指定认证文件名/etc/pam.d/vsftpd\nuserlist_enable=YES\n#设定userlist_file中的用户将不得使用FTP\ntcp_wrappers=YES\n#设定支持TCP Wrappers\nchroot_local_user=YES\n#限制所有用户在主目录\n#限制所有用户在主目录\n#↓↓↓↓↓↓↓↓↓↓↓\n#↓↓↓↓↓↓↓↓↓↓↓\n#以下这些是关于Vsftpd虚拟用户支持的重要配置项目。默认Vsftpd.conf中不包含这些设定项目，需要自己手动添加配置\nguest_enable=YES\n#设定启用虚拟用户功能\nguest_username=viture_user\n#指定虚拟用户的宿主用户\n#virtual_use_local_privs=YES\n#设定虚拟用户的权限符合他们的宿主用户 \nuser_config_dir=/etc/vsftpd/vconf\n#设定虚拟用户个人Vsftp的配置文件存放路径。也就是说，这个被指定的目录里，将存放每个Vsftp虚拟用户个性的配置文件，\n#一个需要注意的地方就是这些配置文件名必须和虚拟用户名相同。\nallow_writeable_chroot=YES\nanon_upload_enable=YES\n# 匿名用户允许创建文件\nanon_mkdir_write_enable=YES\nanon_other_write_enable=YES\n")])])]),s("h2",{attrs:{id:"创建载体用户"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建载体用户"}},[t._v("#")]),t._v(" 创建载体用户")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useradd")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v(" /home/viture_user "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-s")]),t._v("  /sbin/nologin viture_user\n")])])]),s("h2",{attrs:{id:"修改载体用户目录权限"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#修改载体用户目录权限"}},[t._v("#")]),t._v(" 修改载体用户目录权限")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("chmod")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("755")]),t._v(" /home/viture_user\n")])])]),s("h2",{attrs:{id:"创建虚拟用户表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建虚拟用户表"}},[t._v("#")]),t._v(" 创建虚拟用户表")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" /etc/vsftpd/viture_user_list.txt\n")])])]),s("div",{staticClass:"language-txt extra-class"},[s("pre",{pre:!0,attrs:{class:"language-txt"}},[s("code",[t._v("aa\n123\nbb\n456\ncc\n789\n")])])]),s("h2",{attrs:{id:"生成db文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#生成db文件"}},[t._v("#")]),t._v(" 生成db文件")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("db_load "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-T")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-t")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("hash")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" /etc/vsftpd/viture_user_list.txt /etc/vsftpd/viture_user_list.txt.db\n")])])]),s("h2",{attrs:{id:"设置认证文件pam"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#设置认证文件pam"}},[t._v("#")]),t._v(" 设置认证文件PAM")]),t._v(" "),s("h3",{attrs:{id:"备份pam文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#备份pam文件"}},[t._v("#")]),t._v(" 备份pam文件")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cp")]),t._v(" /etc/pam.d/vsftpd /etc/pam.d/vsftpd.backup\n")])])]),s("p",[t._v("将前面的都注释，在最后加上（viture_user_list.txt指的是viture_user_list.txt.db）")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" /etc/pam.d/vsftpd\n")])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("auth    sufficient      /lib64/security/pam_userdb.so    db=/etc/vsftpd/viture_user_list.txt\naccount sufficient      /lib64/security/pam_userdb.so    db=/etc/vsftpd/viture_user_list.txt\n# 独立为虚拟用户配置\n\n/etc/vsftpd/vsftpd.conf 添加一句配置\n// 单独的虚拟用户配置文件放在 /etc/vsftpd/viture_user_dir （位置随意指定）\nuser_config_dir=/etc/vsftpd/viture_user_dir\n创建一个虚拟用户登录目录（位置随意）\nmkdir /tmp/viture_user1\n\n在/etc/vsftpd/viture_user_dir文件夹下新建文件（虚拟用户名就是改文件名）\n\nanon_upload_enable=YES\n# 匿名用户允许创建文件\nanon_mkdir_write_enable=YES\nanon_other_write_enable=YES\nlocal_root=/tmp/viture_user1\n")])])]),s("p",[t._v("这样/etc/vsftpd/viture_user_dir 下和文件同名的虚拟用户设置就是该文件，若没有则是/vsftpd/vsftpd.conf")])])}),[],!1,null,null,null);s.default=r.exports}}]);