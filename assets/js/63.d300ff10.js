(window.webpackJsonp=window.webpackJsonp||[]).push([[63],{345:function(s,t,a){"use strict";a.r(t);var e=a(10),n=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"nexus3"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nexus3"}},[s._v("#")]),s._v(" "),t("center",[s._v("nexus3")])],1),s._v(" "),t("h2",{attrs:{id:"安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /docker/nexus3/data\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-R")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("777")]),s._v(" /docker/nexus3/data\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /docker/nexus3/\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull sonatype/nexus3:3.65.0\n")])])]),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" docker-compose.yml\n")])])]),t("div",{staticClass:"language-yml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nexus3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sonatype/nexus3:3.65.0'")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nexus3\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("hostname")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nexus3\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" /docker/nexus3/data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/nexus"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("data \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'5000:5000'")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'8081:8081'")]),s._v("\n")])])]),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" up "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v("\nfirewall-cmd "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--permanent")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--zone")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("public --add-port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8081")]),s._v("/tcp\nfirewall-cmd "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--reload")]),s._v("\n")])])]),t("h3",{attrs:{id:"修改密码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改密码"}},[s._v("#")]),s._v(" 修改密码")]),s._v(" "),t("ol",[t("li",[s._v("访问 http://ip:8081(参考 https://www.gl.sh.cn/2021/06/19/npm_si_you_hua_docker_fang_shi_bu_shu.html)")])]),s._v(" "),t("p",[s._v("刚部署完成可能需要等待1-2分钟才可正常进入页面\n账号："),t("code",[s._v("admin")]),s._v("\n密码：")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /docker/nexus3/data/admin.password\n")])])]),t("ol",{attrs:{start:"2"}},[t("li",[t("p",[s._v("修改密码,我改成了"),t("code",[s._v("614489858")])])]),s._v(" "),t("li",[t("p",[s._v("修改密码后提示是否启用匿名访问，需要选择enable，否则npm本地仓库在使用时会出现访问失败，需要登录的报错.\n若操作失误，可以打开设置页面 Security -> Anonymous，勾选 Allow anonymous users to access the server 即可，点击 save 保存")])])]),s._v(" "),t("h2",{attrs:{id:"npm"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#npm"}},[s._v("#")]),s._v(" npm")]),s._v(" "),t("h3",{attrs:{id:"npm配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#npm配置"}},[s._v("#")]),s._v(" npm配置")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("打开设置 -> Repository -> repositories 页面，点击 "),t("code",[s._v("Create repository")]),s._v(" 按钮，创建仓库")])]),s._v(" "),t("li",[t("p",[s._v("先创建npm(proxy) 仓库，即代理仓库，填入仓库名以及代理地址，代理地址可使用 npm 官方镜像地址"),t("code",[s._v("https://registry.npmjs.org")]),s._v("。我这里仓库名为"),t("code",[s._v("proxy_npm")])])]),s._v(" "),t("li",[t("p",[s._v("创建 npm(hosted) 仓库，即私服仓库.输入仓库名即可点击底部 Creaete repository 完成创建。我这里仓库名为"),t("code",[s._v("hosted_npm")])])]),s._v(" "),t("li",[t("p",[s._v("创建 npm(group) 仓库，npm 组.当我们从 npm(group) 这个仓库安装 npm 包时，首先会查看该仓库中是否存在，不存在时则会使用代理仓库到官方仓库进行下载.创建 npm(group) 需要填写仓库名，然后将 npm(proxy) 和 proxy(hosted) 设置为成员即可，点击底部 Creaete repository 完成创建.我这里仓库名为"),t("code",[s._v("group_npm")])])])]),s._v(" "),t("h3",{attrs:{id:"使用npm"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用npm"}},[s._v("#")]),s._v(" 使用npm")]),s._v(" "),t("ol",[t("li",[s._v("在另一台机器上执行npm install时，添加–registry指定私有npm仓库地址，下代码示例为我本地虚拟机测试ip，需根据实际部署ip进行更改")])]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" axios  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--registry")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://192.168.2.200:8081/repository/group_npm/\n")])])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("如果觉得每次都需要指定 --registry 的方式较麻烦，我们可以在需要安装npm依赖的机器上使用")])]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" config "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" registry http://192.168.2.200:8081/repository/group_npm/\n")])])]),t("h3",{attrs:{id:"创建账户"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建账户"}},[s._v("#")]),s._v(" 创建账户")]),s._v(" "),t("p",[s._v("Security/Users 添加一个账户")]),s._v(" "),t("h4",{attrs:{id:"激活前权限"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#激活前权限"}},[s._v("#")]),s._v(" 激活前权限")]),s._v(" "),t("p",[s._v("Security/Realms 激活 npm Bearer Token Realm\n激活之后需要登陆")]),s._v(" "),t("p",[s._v("登录:\nnpm login --registry=仓库地址\n例如:")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" login "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--registry")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://192.168.2.200:8081/repository/hosted_npm/\n")])])]),t("p",[s._v("注意：免费用户只能发布到hosted仓库，下载时可以从hosted仓库下载，也可以从group仓库下载")]),s._v(" "),t("p",[s._v("发布:")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" publish "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--registry")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://192.168.2.200:8081/repository/hosted_npm/ "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("私有"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" publish "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--access")]),s._v(" public "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--registry")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://192.168.2.200:8081/repository/hosted_npm/ "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("公有"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),t("p",[s._v("安装:")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" npm-package "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--registry")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://192.168.2.200:8081/repository/hosted_npm/\n")])])]),t("p",[s._v("或者从group仓库下载")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" npm-package "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--registry")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://192.168.2.200:8081/repository/group_npm/\n")])])]),t("h4",{attrs:{id:"ts包发布"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ts包发布"}},[s._v("#")]),s._v(" ts包发布:")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("npx tsdx create mylib\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" mylib\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" src/index.ts\n")])])]),t("div",{staticClass:"language-ts extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ts"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("sum")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("a"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("number")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" b"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("number")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'development'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),s._v(" process"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NODE_ENV")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'boop'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" a "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" b"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" testObj "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'测试'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("fn")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token template-string"}},[t("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("hello ")]),t("span",{pre:!0,attrs:{class:"token interpolation"}},[t("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),t("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" run build\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" login "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--registry")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://192.168.2.200:8081/repository/hosted_npm/\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" publish "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--access")]),s._v(" public "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--registry")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://192.168.2.200:8081/repository/hosted_npm/\n")])])]),t("h2",{attrs:{id:"docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker"}},[s._v("#")]),s._v(" docker")]),s._v(" "),t("ol",[t("li",[s._v("建立store：点击顶部设置icon按钮 -> 左侧菜单选择"),t("code",[s._v("Blob Stores")]),s._v(" -> "),t("code",[s._v("Type")]),s._v("选择File，"),t("code",[s._v("Name")]),s._v("随意，我填写的"),t("code",[s._v("docker-store")]),s._v(" -> 点击右下角"),t("code",[s._v("Save")])]),s._v(" "),t("li",[s._v("建立repositories：点击顶部设置icon按钮 -> 左侧菜单选择"),t("code",[s._v("Repository")]),s._v(" -> 选择"),t("code",[s._v("Repositories")]),s._v("子选项 -> 点击"),t("code",[s._v("Create repository")]),s._v("按钮 -> 选择"),t("code",[s._v("docker(hosted)")]),s._v(" -> 填写"),t("code",[s._v("Name")]),s._v("，我填写的"),t("code",[s._v("hosted-docker")]),s._v(" -> "),t("strong",[s._v("勾选"),t("code",[s._v("HTTP")]),s._v("选项，填入端口")]),s._v("(注意:一定是http而不是https)，我选择"),t("code",[s._v("9000")]),s._v("(后续拉取和推送进行是使用此端口进行的，而不是nexus本身对外暴露的端口。) -> 勾选"),t("code",[s._v("Allow anonymous docker pull")]),s._v(" -> 勾选"),t("code",[s._v("Docker Registry API Support")]),s._v("下"),t("code",[s._v("Enable Docker V1 API")]),s._v(" -> 选择"),t("code",[s._v("Storage")]),s._v("下"),t("code",[s._v("Blob store")]),s._v("选项,选择刚才创建的"),t("code",[s._v("docker-store")]),s._v(" -> 点击底部"),t("code",[s._v("Create repository")]),s._v("按钮完成创建")]),s._v(" "),t("li",[s._v("点击顶部设置icon按钮 -> 左侧菜单选择"),t("code",[s._v("Security")]),s._v("下"),t("code",[s._v("Realms")]),s._v("选项，将左侧"),t("code",[s._v("Docker Bearer Token Realm")]),s._v("添加到右侧")]),s._v(" "),t("li",[s._v("由于使用的http，需要修改docker配置文件daemon.json的insecure-registries(所谓的 “insecure registry”，是指那些没有使用 HTTPS 或者使用了自签名证书的 Docker registry1。默认情况下，Docker 只允许与使用 HTTPS 的 registry 进行通信。)")])]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/docker/daemon.json\n")])])]),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"registry-mirrors"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://s3l9h6jt.mirror.aliyuncs.com"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"insecure-registries"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.2.200:9000"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])])]),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("systemctl daemon-reload "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" systemctl restart "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])])]),t("p",[s._v("重启docker镜像")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" down\n")])])]),t("p",[s._v("修改"),t("code",[s._v("docker-compose.yml")]),s._v("将9000端口暴露")]),s._v(" "),t("div",{staticClass:"language-yml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nexus3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sonatype/nexus3:3.65.0'")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nexus3\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("hostname")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nexus3\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" /docker/nexus3/data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/nexus"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("data \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'5000:5000'")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'8081:8081'")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'9000:9000'")]),s._v("\n")])])]),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" up "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v("\n")])])]),t("h3",{attrs:{id:"测试"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#测试"}},[s._v("#")]),s._v(" 测试")]),s._v(" "),t("p",[s._v("登录docker")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" login "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".2.200:9000\n")])])]),t("p",[s._v("账号是"),t("code",[s._v("admin")]),s._v(",密码是Nexus3的密码，在这里也就是"),t("code",[s._v("614489858")])]),s._v(" "),t("p",[s._v("挑一个体积小的镜像测试,docker打包语法")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" tag "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("image-name:tag"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" docker-store-ip:docker-store-port/"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("image-name:tag"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),t("p",[s._v("注意一定是"),t("code",[s._v("docker-store-ip:docker-store-port")]),s._v("开头")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" tag registry.gitlab.com/gitlab-org/cluster-integration/auto-build-image:v1.0.0 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".2.200:9000/demoimage:v1.0.0\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" push "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".2.200:9000/demoimage:v1.0.0\n")])])]),t("p",[s._v("点击顶部首页icon(设置icon前一个)按钮 -> 选择"),t("code",[s._v("Browse")]),s._v(" -> 右侧选中"),t("code",[s._v("hosted-docker")]),s._v("可以查看是否推送成功.\n删除本地镜像，再拉取试一下")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".2.200:9000/demoimage:v1.0.0\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".2.200:9000/demoimage:v1.0.0\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images\n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);